  <!DOCTYPE html>
  <!-- saved from url=(0049)http://datajournalism.ntu.edu.tw/post/89535832028 -->
  <html class="no-js" lang="en">
  <head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">




  

  <!-- Basic Page Settings -->

  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <!-- Li-Yuan Custom -->
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.2.0/css/bootstrap.min.css">
  <link rel="stylesheet" type="text/css" href="./materiel/bootstrap-select.min.css">
  <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
  <script src="http://d3js.org/d3.v3.min.js"></script>
  <script src="http://labratrevenge.com/d3-tip/javascripts/d3.tip.v0.6.3.js"></script>
  <script src="./materiel/bootstrap-select.js"></script>
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.2.0/js/bootstrap.min.js"></script>
  <script src="./materiel/group_3.js"></script>
  
  
  <style>
    .block-title{
      font-weight: bold;
    }
    .container{
      max-width: 1080px;
      margin-left: auto;
      margin-right: auto;

    }
    .nav-img{
      display: inline-block;
      width:24.5%;
      cursor: pointer;
    }

    body{
      background-color: rgb(252,224,191);
    }
    .axis path,
    .axis line {
      fill: none;
      stroke: #000;
      shape-rendering: crispEdges;
    }

    .bar {
      fill: steelblue;
    }

    .x.axis path {
      display: none;
    }
    .d3-tip {
      line-height: 1;
      font-weight: bold;
      padding: 12px;
      background: rgba(0, 0, 0, 0.8);
      color: #fff;
      border-radius: 2px;
      z-index: 10000;
    }

    /* Creates a small triangle extender for the tooltip */
    .d3-tip:after {
      box-sizing: border-box;
      display: inline;
      font-size: 10px;
      width: 100%;
      line-height: 1;
      color: rgba(0, 0, 0, 0.8);
      content: "\25BC";
      position: absolute;
      text-align: center;
      z-index: 10000;
    }

    /* Style northward tooltips differently */
    .d3-tip.n:after {
      margin: -1px 0 0 0;
      top: 100%;
      left: 0;
      z-index: 10000;
    }
  </style>
  <script type="text/javascript">
    function drawSvg(filename){
    var margin = {top: 20, right: 20, bottom: 30, left: 40},
        width = 700 - margin.left - margin.right,
        height = 300 - margin.top - margin.bottom;

    var x = d3.scale.ordinal()
        .rangeRoundBands([20, width-100], .1);

    var y = d3.scale.linear()
        .rangeRound([height, 0]);

    var color = d3.scale.ordinal()
        .range(["#F08000", "#0084C0", "#DA5682", "#FABE00"]);

    var xAxis = d3.svg.axis()
        .scale(x)
        .orient("bottom");

    var yAxis = d3.svg.axis()
        .scale(y)
        .orient("left")
        .tickFormat(d3.format(".2s"));

    var tip = d3.tip()
      .attr('class', 'd3-tip')
      .offset([-10, 0])
      .html(function(d) {
        return "<span style='color:red'>" + ((d.y1 - d.y0).toFixed(2)) + "%</span>";
      })

    var svg = d3.select("#stack_bar_chart")
        .attr("width", width + margin.left + margin.right)
        .attr("height", height + margin.top + margin.bottom)
      .append("g")
        .attr("transform", "translate(" + margin.left + "," + margin.top + ")");

    svg.call(tip);

    d3.csv(filename, function(error, data) {
      color.domain(d3.keys(data[0]).filter(function(key) { return key !== "Year"; }));

      color.domain().reverse();
      data.forEach(function(d) {
        var y0 = 0;
        d.ages = color.domain().map(function(name) { return {name: name, y0: y0, y1: y0 += +d[name]}; });
        d.total = d.ages[d.ages.length - 1].y1;
      });
      color.domain().reverse();

      data.sort(function(a, b) { return parseInt(a.Year) - parseInt(b.Year); });

      x.domain(data.map(function(d) { return d.Year; }));
      y.domain([0, d3.max(data, function(d) { return d.total; })]);

      svg.append("g")
          .attr("class", "x axis")
          .attr("transform", "translate(0," + height+ ")")
          .call(xAxis)
          .append("text")
          .attr("x", width-50)
          .attr("y", 6)
          .attr("dy", ".71em")
          .style("text-anchor", "end")
          .style("font-size","16px")
          .style("z-index","10000")
          .text("年份");

      svg.append("g")
          .attr("class", "y axis")
          .call(yAxis)
        .append("text")
          .attr("transform", "rotate(-90)")
          .attr("x", 0)
          .attr("y", 6)
          .attr("dy", ".71em")
          .style("text-anchor", "end")
          .style("font-size","16px")
          .text("百分比");

      var year = svg.selectAll(".year")
          .data(data)
        .enter().append("g")
          .attr("class", "g")
          .attr("transform", function(d) { return "translate(" + x(d.Year) + ",0)"; });

      year.selectAll("rect")
          .data(function(d) { return d.ages; })
        .enter().append("rect")
          .attr("width", 54)
          .attr("y", function(d) { return y(d.y1); })
          .attr("transform", "translate(30,0 )")
          .attr("height", function(d) { return y(d.y0) - y(d.y1); })
          .style("fill", function(d) { return color(d.name); })
          .on('mouseover', tip.show)
          .on('mouseout', tip.hide);

      var legend = svg.selectAll(".legend")
          .data(color.domain().slice())
        .enter().append("g")
          .attr("class", "legend")
          .attr("transform", function(d, i) { return "translate(0," + i * 20 + ")"; });

      legend.append("rect")
          .attr("x", width -18)
          .attr("width", 18)
          .attr("height", 18)
          .style("fill", color);

      legend.append("text")
          .attr("x", width - 24)
          .attr("y", 9)
          .attr("dy", ".35em")
          .style("text-anchor", "end")
          .text(function(d) { return d; });

    });

  

  }
  	
  function hist_and_pie(divid){
	d3.csv("./materiel/his_data.csv",function(error,his_data){
                                d3.csv("./materiel/pie_data.csv",function(error,pie_data){
                                        var his_1 = [];
                                        var his_2 = [];
                                        var his_3 = [];
                                        var his_4 = [];
                                        var type_list = ["研究所以上","大專院校","高中職","高中職以下學歷"];
                                        var pie_pro_data = [];
					
                                        for(var i = 0;i<his_data.length;i++){
						//alert(pie_data[i].地區);
						
                                                his_1.push([his_data[i].地區,parseFloat(his_data[i].研究所以上)]);
                                                his_2.push([his_data[i].地區,parseFloat(his_data[i].大專院校)]);
                                                his_3.push([his_data[i].地區,parseFloat(his_data[i].高中職)]);
                                                his_4.push([his_data[i].地區,parseFloat(his_data[i].高中職以下學歷)]);
                                                pie_pro_data.push([pie_data[i].地區,parseFloat(pie_data[i].研究所以上),parseFloat(pie_data[i].大專院校),parseFloat(pie_data[i].高中職),parseFloat(pie_data[i].高中職以下學歷)]);
						
                                        }
					
					//alert("fuck");
					
                                        var color = d3.scale.category10();
                                        his_pro_data = [his_1,his_2,his_3,his_4];
                                        hg = historgram(divid+" #hist",his_1,pie_pro_data,color(0));
                                        pie = piechart(divid+" #pie",pie_pro_data[2],his_pro_data,type_list);
                                        legend(divid+" #legend",type_list);
					
                                })
                        })
	
  }
  
	
  $(document).ready(function(){
    $("#banner").click(function(){
      if(!$("#block-0").is(":visible")){
       $("div.block").hide(); 
       $("#block-0").show();
      }
    });
    $("#button-1").click(function(){
      if(!$("#block-1").is(":visible")){
       $("div.block").hide(); 
       $("#block-1").show();
      }
    });
    $("#button-2").click(function(){
      if(!$("#block-2").is(":visible")){
       $("div.block").hide(); 
       $("#block-2").show();
      }
    });
    $("#button-3").click(function(){
      if(!$("#block-3").is(":visible")){
       $("div.block").hide(); 
       $("#block-3").show();
      }
    });
    $("#button-4").click(function(){
      if(!$("#block-4").is(":visible")){
       $("div.block").hide(); 
       $("#block-4").show();
      }
    });
    hist_and_pie("#block-1");
    $('.selectpicker').selectpicker();
    drawSvg("./materiel/全台鄉鎮市長學歷分布.csv");

    $( "#selectpicker" )
      .change(function () {
        $("#stack_bar_chart>g").fadeOut( "slow", function() {
          $(this).remove();
          drawSvg("./materiel/"+$( "select option:selected" ).text()+".csv");
        });

      });

    });

    
  </script>
  
  <!-- Li-Yuan Custom -->

</head>



<body>
  <div class="container">
    <img id="banner" style="width:100%;cursor:pointer;"src="./materiel/banner.png">
    <div style="margin-left:auto;margin-right:auto;">
      <img id="button-1" class="nav-img" src="./materiel/全台學歷分布一覽.png">
      <img id="button-2" class="nav-img" src="./materiel/近四屆學歷比例變化.png">
      <img id="button-3" class="nav-img" src="./materiel/當選學歷次數大比拚.png">
      <img id="button-4" class="nav-img" src="./materiel/學歷影響當選比例.png">
    </div>
    <div id="block-0" class="block" >
      <img src="./materiel/書本icon.png"style="margin-top:20px;margin-left:100px;width:310px;height:380px;display:inline-block;vertical-align:top;" />
      <div style="position:relative;top:140px;left:30px;display:inline-block;width:400px">
        <p style="display:inline-block;font-size:20px;">
          我們希望藉由整理近五屆選舉人的學經歷背景，了解各層級的當選人學歷多分布在研究所、大專院校、高中職、還是以下的學位。
        </p>
      </div>
    </div>
    <div id="block-1" class="block" style="display:none">
        <div id ="hist" class ="diagram" style ="display:inline-block;">
		    </div>
		    <div id ="pie" class ="diagram" style="display:inline-block;font-size:20px;">
			      <p id="dis_name" style="font-size:15px;height:15px;"></p>
			      <div style="font-size:15px;height:15px;">學位分佈</div>
		    </div>
		    <div id ="legend" style="display:inline-block;">
		    </div>
    </div>
    <div id="block-2" class="block" style="display:none">
      <h2 class="block-title">近四屆學歷比例變化</h2>
      <select id="selectpicker" class="selectpicker">
        <option>全台鄉鎮市長學歷分布</option>
        <option>全台直轄市議員學歷分布</option>
        <option>全台縣市議員學歷分布</option>
        <option>全台縣市長學歷分布</option>
        <option>全台直轄市長學歷分布</option>
      </select>
      <br />
      <svg style="display:inline-block;vertical-align:bottom;"id="stack_bar_chart"></svg>
      <div style="display:inline-block;width:300px">
        <p style="display:inline-block;font-size:20px;">
        左邊圖表以直轄、縣市首長及議員和鄉鎮市長為基礎，呈現近四屆中，各個學歷所占之比例。五張圖可分為兩種趨勢：一是以學士以上學歷為多數者，如：直轄市長、議員以及縣市長；二是以大學及高中職學歷居多者，如：縣市議員及鄉鎮市長。發現在越高的層級，高學歷者比重也越多。
        </p>
      </div>
    </div>
    <div id="block-3" class="block" style="display:none">
      <h2 style="padding-left:100px;"class="block-title">當選學歷次數大比拼</h2>
      <img src="./materiel/3.png"style="margin-left:100px;width:436px;height:320px;display:inline-block;vertical-align:bottom;" />
      <div style="display:inline-block;width:400px;position:relative;left:30px">
        <p style="display:inline-block;font-size:20px;">
        本表根據近四屆之直轄、縣市首長及議員和鄉鎮市長做統計，計算在當屆當選者中，何種學歷為最大宗。以此表來看，在縣市首長層級中，以研究所以上學歷者為多數。而在直轄市議員中，呈現碩士以上和學士持平的現象。在縣市議員，多為大學學歷者勝出。 最後，在鄉鎮市長部分，則是大專院校和高中職學歷勝出次數相同。而在本表中，高中職以下的學歷者幾乎占當選人的極少數。
        </p>
      </div>
    </div>
    <div id="block-4" class="block" style="display:none;padding-top:20px">
      <img src="./materiel/直轄市長.png"style="display:inline-block;width:200px;height:257px" />
      <img src="./materiel/直轄市議員.png"style="display:inline-block;width:200px;height:257px" />
      <img src="./materiel/縣市長.png"style="display:inline-block;width:200px;height:257px" />
      <img src="./materiel/縣市議員.png"style="display:inline-block;width:200px;height:257px" />
      <img src="./materiel/鄉鎮市長.png"style="display:inline-block;width:200px;height:257px" />
      <div >
        <p style="font-size:20px;">
        我們選取近四屆直轄市長、直轄市議員、縣市長、縣市議員及鄉鎮市長候選人作為研究對象,比較上述行政層級候選人與當選人的學歷分布,藉以檢視相異行政層級間,學歷背景對於選舉結果的影響。結果顯示,直轄市長層級中,近四屆當選人最高學歷皆為研究所(以上);近四屆直轄市議員當選人最高學歷以研究所(以上)及大專院校為多,分別是169及170名;另一方面,近四屆縣市長及縣市議員皆以研究所(以上)的當選比例最高;近四屆鄉鎮市長參選人學歷分布較其他層級平均,相異學歷背景的當選人與落選人比例約各佔五成。
        </p>
      </div>
    </div>
  </div>
  
  
  


  
</body>
</html>
